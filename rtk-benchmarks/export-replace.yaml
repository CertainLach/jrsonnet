name: "Export (Replace)"
id: "export-replace"
description: "Comparing rtk with tk for export with existing manifests (replace mode)."

fixtures:
  static_envs: 100
  inline_files: 5
  envs_per_inline_file: 20
  resources_per_env: 10

# Setup exports all environments first, then we benchmark re-exporting
setup: "export {export_dir} {all_static_env_paths} {all_inline_file_paths} --recursive"

tests:
  - name: "Single Static Environment"
    description: "Re-exporting a single static environment with {resources_per_env} resources (3 Kubernetes objects each)."
    warmup: 2
    command: "export {export_dir} {single_static_dir} --merge-strategy=replace-envs"

  - name: "Single Inline Environment"
    description: "Re-exporting a single inline environment file containing {envs_per_inline_file} environments."
    warmup: 2
    command: "export {export_dir} {single_inline_file} --recursive --merge-strategy=replace-envs"

  - name: "All Environments"
    description: "Re-exporting all {total_envs} environments listed on command line."
    warmup: 1
    command: "export {export_dir} {all_static_env_paths} {all_inline_file_paths} --recursive --merge-strategy=replace-envs"
